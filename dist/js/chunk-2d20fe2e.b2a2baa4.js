(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20fe2e"],{b615:function(e,t,o){"use strict";o.r(t);var n=o("7a23"),a={class:"text-end"},c={class:"table"},l=Object(n["h"])("thead",null,[Object(n["h"])("tr",null,[Object(n["h"])("th",{scope:"col"},"名稱"),Object(n["h"])("th",{scope:"col"},"代碼"),Object(n["h"])("th",{scope:"col",class:"text-end"},"折扣百分比"),Object(n["h"])("th",{scope:"col"},"到期日"),Object(n["h"])("th",{scope:"col"},"是否套用"),Object(n["h"])("th",{scope:"col"},"編輯")])],-1),s={scope:"row"},u={class:"text-end"},d={key:0,class:"text-success"},i={key:1,class:"text-muted"},p={class:"btn-group",role:"group"},r=["onClick"],b=["onClick"];function h(e,t,o,h,m,j){var O=Object(n["J"])("Loading"),f=Object(n["J"])("Pagination"),g=Object(n["J"])("CouponEditModal"),C=Object(n["J"])("CouponDeleteModal");return Object(n["z"])(),Object(n["g"])(n["a"],null,[Object(n["k"])(O,{active:m.isLoading},null,8,["active"]),Object(n["h"])("div",a,[Object(n["h"])("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=function(e){return j.openCouponEditModal(!0)})}," 新增優惠券 ")]),Object(n["k"])(f,{pages:m.pagination,onChangePage:j.getCoupons,onPreviousPage:j.getCoupons,onNextPage:j.getCoupons},null,8,["pages","onChangePage","onPreviousPage","onNextPage"]),Object(n["h"])("table",c,[l,Object(n["h"])("tbody",null,[(Object(n["z"])(!0),Object(n["g"])(n["a"],null,Object(n["H"])(m.coupons,(function(t){return Object(n["z"])(),Object(n["g"])("tr",{key:t.id},[Object(n["h"])("th",s,Object(n["M"])(t.title),1),Object(n["h"])("td",null,Object(n["M"])(t.code),1),Object(n["h"])("td",u,Object(n["M"])(t.percent)+" %",1),Object(n["h"])("td",null,Object(n["M"])(e.$filters.date(t.due_date)),1),Object(n["h"])("td",null,[t.is_enabled?(Object(n["z"])(),Object(n["g"])("span",d,"啟用")):(Object(n["z"])(),Object(n["g"])("span",i,"未啟用"))]),Object(n["h"])("td",null,[Object(n["h"])("div",p,[Object(n["h"])("button",{type:"button",class:"btn btn-outline-primary",onClick:function(e){return j.openCouponEditModal(!1,t,m.pagination)}}," 編輯 ",8,r),Object(n["h"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(e){return j.openCouponDeleteModal(t,m.pagination)}}," 刪除 ",8,b)])])])})),128))])]),Object(n["k"])(g,{ref:"couponEditModal",coupon:m.tempCoupon,onUpdateCoupon:j.updateCoupons},null,8,["coupon","onUpdateCoupon"]),Object(n["k"])(C,{ref:"couponDeleteModal",coupon:m.tempDeleteCoupon,onDeleteCoupon:j.deleteCoupon},null,8,["coupon","onDeleteCoupon"])],64)}var m=o("1da1"),j=o("5530"),O=(o("96cf"),o("99af"),{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"modalLabel","aria-hidden":"true",ref:"modal"}),f={class:"modal-dialog modal-md",role:"document"},g={class:"modal-content border-0"},C=Object(n["h"])("div",{class:"modal-header bg-dark text-white"},[Object(n["h"])("h5",{class:"modal-title",id:"exampleModalLabel"},[Object(n["h"])("span",null,"新增優惠券")]),Object(n["h"])("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),v={class:"modal-body"},x={class:"mb-3"},M=Object(n["h"])("label",{for:"title",class:"form-label"},"名稱",-1),y={class:"mb-3"},k=Object(n["h"])("label",{for:"code",class:"form-label"},"代碼",-1),w={class:"mb-3"},_=Object(n["h"])("label",{for:"percent",class:"form-label"},"折扣百分比",-1),D={class:"mb-3"},$=Object(n["h"])("label",{for:"due_date",class:"form-label"},"到期日",-1),P=Object(n["h"])("hr",null,null,-1),L={class:"mb-3"},E={class:"form-check"},U=Object(n["h"])("label",{class:"form-check-label",for:"is_enabled"}," 是否套用 ",-1),z={class:"modal-footer"},J=Object(n["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function R(e,t,o,a,c,l){return Object(n["z"])(),Object(n["g"])("div",O,[Object(n["h"])("div",f,[Object(n["h"])("div",g,[C,Object(n["h"])("div",v,[Object(n["h"])("form",null,[Object(n["h"])("div",x,[M,Object(n["W"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入優惠券名稱","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.tempCoupon.title=e})},null,512),[[n["Q"],c.tempCoupon.title]])]),Object(n["h"])("div",y,[k,Object(n["W"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"code",placeholder:"請輸入優惠券代碼","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.tempCoupon.code=e})},null,512),[[n["Q"],c.tempCoupon.code]])]),Object(n["h"])("div",w,[_,Object(n["W"])(Object(n["h"])("input",{type:"text",class:"form-control",id:"percent",placeholder:"請輸入折扣百分比","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.tempCoupon.percent=e})},null,512),[[n["Q"],c.tempCoupon.percent,void 0,{number:!0}]])]),Object(n["h"])("div",D,[$,Object(n["W"])(Object(n["h"])("input",{type:"date",class:"form-control",id:"due_date",placeholder:"請輸入到期日","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.tempCoupon.due_date=e})},null,512),[[n["Q"],c.tempCoupon.due_date]])]),P,Object(n["h"])("div",L,[Object(n["h"])("div",E,[Object(n["W"])(Object(n["h"])("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.tempCoupon.is_enabled=e})},null,512),[[n["P"],c.tempCoupon.is_enabled]]),U])])])]),Object(n["h"])("div",z,[J,Object(n["h"])("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=function(t){return e.$emit("update-coupon",c.tempCoupon)})}," 新增 ")])])])],512)}var N=o("e0ae"),V={mixins:[N["a"]],props:{coupon:{type:Object,default:function(){return{}}}},data:function(){return{modal:{},tempCoupon:{}}},watch:{coupon:function(){this.tempCoupon=this.coupon}}},W=o("6b0d"),Q=o.n(W);const S=Q()(V,[["render",R]]);var F=S,H={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"modalLabel","aria-hidden":"true",ref:"modal"},T={class:"modal-dialog modal-xl",role:"document"},q={class:"modal-content border-0"},A={class:"modal-header bg-danger text-white"},B={class:"modal-title",id:"exampleModalLabel"},G=Object(n["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),I={class:"modal-body"},K=Object(n["j"])(" 是否刪除 "),X={class:"text-danger fw-bold"},Y=Object(n["j"])(" ？（刪除後無法復原） "),Z={class:"modal-footer"},ee=Object(n["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function te(e,t,o,a,c,l){return Object(n["z"])(),Object(n["g"])("div",H,[Object(n["h"])("div",T,[Object(n["h"])("div",q,[Object(n["h"])("div",A,[Object(n["h"])("h5",B,[Object(n["h"])("span",null,"刪除 "+Object(n["M"])(c.tempCoupon.title),1)]),G]),Object(n["h"])("div",I,[K,Object(n["h"])("span",X,Object(n["M"])(c.tempCoupon.title),1),Y]),Object(n["h"])("div",Z,[ee,Object(n["h"])("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=function(t){return e.$emit("delete-coupon",c.tempCoupon)})}," 確認刪除 ")])])])],512)}var oe={mixins:[N["a"]],props:{coupon:{type:Object}},data:function(){return{modal:{},tempCoupon:{}}},watch:{coupon:function(){this.tempCoupon=this.coupon}}};const ne=Q()(oe,[["render",te]]);var ae=ne,ce=o("1799"),le={components:{CouponEditModal:F,CouponDeleteModal:ae,Pagination:ce["a"]},inject:["pushMessageStateForDashboard"],data:function(){return{coupons:[],pagination:{},tempCoupon:{},tempDeleteCoupon:{},isNew:!1,isLoading:!1}},methods:{openCouponDeleteModal:function(e,t){this.tempDeleteCoupon=Object(j["a"])(Object(j["a"])({},e),t),this.$refs.couponDeleteModal.showModal()},deleteCoupon:function(e){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function o(){var n,a,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/admin/coupon/").concat(e.id),o.next=4,t.$http.delete(n);case 4:return a=o.sent,c=e.current_page,o.next=8,t.getCoupons(c);case 8:t.$refs.couponDeleteModal.hideModal(),t.pushMessageStateForDashboard(a,e,"刪除"),console.log("deleteCoupon",a),o.next=16;break;case 13:o.prev=13,o.t0=o["catch"](0),console.log(o.t0);case 16:case"end":return o.stop()}}),o,null,[[0,13]])})))()},openCouponEditModal:function(e,t,o){if(e&&(this.tempCoupon={}),!e){var n=Object(j["a"])({},t),a=this.$filters.date(n.due_date);n.due_date=this.$filters.formatDate(a),this.tempCoupon=Object(j["a"])(Object(j["a"])({},n),o)}this.$refs.couponEditModal.showModal(),this.isNew=e},updateCoupons:function(e){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function o(){var n,a,c,l,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/admin/coupon"),a="post",t.isNew||(n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/admin/coupon/").concat(e.id),a="put",c=e.current_page),l={title:e.title,code:e.code,percent:e.percent,due_date:t.$filters.toUnixTimeStamp(e.due_date),is_enabled:e.is_enabled},o.prev=4,o.next=7,t.$http[a](n,{data:l});case 7:return s=o.sent,o.next=10,t.getCoupons(c);case 10:t.$refs.couponEditModal.hideModal(),t.pushMessageStateForDashboard(s,e,c?"更新":"新增"),console.log("updateCoupons",s),o.next=18;break;case 15:o.prev=15,o.t0=o["catch"](4),console.log(o.t0);case 18:case"end":return o.stop()}}),o,null,[[4,15]])})))()},getCoupons:function(e){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function o(){var n,a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,t.isLoading=!0,n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("e-commerce-api","/admin/coupons?page=").concat(e),o.next=5,t.$http.get(n);case 5:a=o.sent,t.coupons=a.data.coupons,t.pagination=a.data.pagination,t.isLoading=!1,console.log("getCoupons",a.data),o.next=15;break;case 12:o.prev=12,o.t0=o["catch"](0),console.log(o.t0);case 15:case"end":return o.stop()}}),o,null,[[0,12]])})))()}},created:function(){this.getCoupons()}};const se=Q()(le,[["render",h]]);t["default"]=se}}]);
//# sourceMappingURL=chunk-2d20fe2e.b2a2baa4.js.map